"use strict";var app=angular.module("blogApp",["restangular","monospaced.elastic"]);app.config(["RestangularProvider","$httpProvider",function(a){a.setBaseUrl("/api"),a.setRequestInterceptor(function(a,b){return"remove"===b?void 0:a})}]),app.controller("MainCtrl",["$scope",function(a){a.views={main:{url:"views/main.html"},nav:{url:"views/nav.html"},footer:{url:"views/footer.html"}}}]),app.controller("BlogCtrl",["$scope","$filter","Restangular",function(a,b,c){var d=c.all("post"),e=c.all("user");c.all("comment"),a.editMode=!1,a.newPost={};var f,g=a.posts=[],h=a.users=[];d.getList().then(function(b){g=a.posts=b[0]}),e.getList().then(function(b){h=a.users=b[0],f=h[0]}),a.isOwner=function(a){return a.user.id===f.id},a.delete=function(b){if(a.isOwner(b)){var c=_.find(g,function(a){return a.id===b.id});console.log(c),b.remove().then(function(){var c=g.indexOf(b);c>-1&&a.splice(c,1)})}},a.save=function(){var b=a.newPost;b.userId=parseInt(f.id),d.post(b,b,"").then(function(a){g.push(a.p),console.log(a)}),a.newPost.title="",a.newPost.content=""},a.sendComment=function(d,e){d.postId=e,c.all("comment").post(d,d,"").then(function(c){g=a.posts=_.map(g,function(a){return a.id==e?(a.comments=b("array")(a.comments),a.comments.push(c.comment),a):a})}),d.author="",d.content=""}}]),angular.module("blogApp").filter("array",function(){return function(a){if(_.isArray(a))return a;var b=[];return b.push(a),b}}),angular.module("blogApp").directive("keyEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){if(13===b.which){if(b.ctrlKey)return;a.$apply(function(){a.$eval(c.keyEnter)}),b.preventDefault()}})}});